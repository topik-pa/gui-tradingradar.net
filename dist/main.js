(()=>{"use strict";const e=()=>{const e=document.querySelector("header"),t=e.querySelector(".icon-menu"),a=e.querySelector("nav");t.addEventListener("click",(()=>{a.classList.toggle("show")}))},t=()=>{const e=document.querySelector("#cookie_layer_accept"),t=document.querySelector("#cookie_layer");""===function(e){const t="tradingradar-net-privacy=",a=document.cookie.split(";");for(let e=0;e<a.length;e++){let s=a[e];for(;" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(t))return s.substring(t.length,s.length)}return""}()&&setTimeout((()=>{t.classList.add("active")}),3e3),e.addEventListener("click",(e=>{e.preventDefault(),function(e,t,a){const s=new Date;s.setTime(s.getTime()+10368e6);const n="expires="+s.toUTCString();document.cookie="tradingradar-net-privacy=true;"+n+";path=/"}(),t.classList.remove("active")}))},a=()=>{const e=document.getElementById("goto_top"),t="visible";window.addEventListener("scroll",function(e,t=300){let a;return(...s)=>{clearTimeout(a),a=setTimeout((()=>{e.apply(this,s)}),t)}}((function(){window.scrollY>=200?e.classList.add(t):e.classList.remove(t)}))),e.addEventListener("click",(()=>{window.scrollTo({top:0,behavior:"smooth"})}))},s={get:async(e="/api/")=>{const t={};return await fetch(window.location.origin+"/"+e,{method:"GET"}).then((e=>(t.status=e.status,e.json()))).then((e=>{t.body=e})).catch((e=>{console.error(e)})),t},post:async(e={},t="/api/")=>{const a={},s={method:"POST",body:JSON.stringify(e)};return await fetch(window.location.origin+"/"+t,s).then((e=>(a.status=e.status,e.json()))).then((e=>{a.body=e})).catch((e=>{console.error(e)})),a}},n=s,o={init:(e,t)=>{(async(e,t)=>{const a=t.querySelector(".gcup"),s=t.querySelector(".gcdown"),n=t.querySelector(".tiup"),o=t.querySelector(".tidown"),r=e.gcup;if(0===r.length)a.querySelector("div:nth-of-type(2)").classList.remove("hide");else{const e=r[0];a.querySelector("div:nth-of-type(3)").classList.remove("hide"),a.querySelector("img").src=`/assets/images/stocks/${e.code}-min.png`,a.querySelector("a h5").innerText=e.name,a.querySelector("a").href=`/analisi/${encodeURI(e.name.toLowerCase().replace(/ /g,"-"))}?isin=${e.isin}`,a.querySelector("#mm20days").innerText=e.mm20days?.value?.toFixed(2),a.querySelector("#mm40days").innerText=e.mm40days?.value?.toFixed(2),a.querySelector("#delta").innerText=`${(e.mm20days?.value-e.mm40days?.value).toFixed(2)}€ / ${((e.mm20days?.value-e.mm40days?.value)/(e.mm40days?.value/100)).toFixed(2)}%`,a.querySelector("#date").innerText=new Date(e.updatedAt).toLocaleString();const t=a.querySelector("ul.sameas");for(let e=0;e<r.length;e++){if(0===e)continue;const a=r[e],s=document.createElement("li"),n=document.createElement("a");n.innerText=a.name,n.title=a.name,n.href=`/analisi/${encodeURI(a.name.toLowerCase().replace(/ /g,"-"))}?isin=${a.isin}`,s.appendChild(n),t.appendChild(s)}}const i=e.gcdown;if(0===i.length)s.querySelector("div:nth-of-type(2)").classList.remove("hide");else{const e=i[0];s.querySelector("div:nth-of-type(3)").classList.remove("hide"),s.querySelector("img").src=`/assets/images/stocks/${e.code}-min.png`,s.querySelector("a h5").innerText=e.name,s.querySelector("a").href=`/analisi/${encodeURI(e.name.toLowerCase().replace(/ /g,"-"))}?isin=${e.isin}`,s.querySelector("#mm20days").innerText=e.mm20days?.value?.toFixed(2),s.querySelector("#mm40days").innerText=e.mm40days?.value?.toFixed(2),s.querySelector("#delta").innerText=`${(e.mm20days?.value-e.mm40days?.value).toFixed(2)}€ / ${((e.mm20days?.value-e.mm40days?.value)/(e.mm40days?.value/100)).toFixed(2)}%`,s.querySelector("#date").innerText=new Date(e.updatedAt).toLocaleString();const t=s.querySelector("ul.sameas");for(let e=0;e<i.length;e++){if(0===e)continue;const a=i[e],s=document.createElement("li"),n=document.createElement("a");n.innerText=a.name,n.title=a.name,n.href=`/analisi/${encodeURI(a.name.toLowerCase().replace(/ /g,"-"))}?isin=${a.isin}`,s.appendChild(n),t.appendChild(s)}}const l=e.tiup;if(0===l.length)n.querySelector("div:nth-of-type(2)").classList.remove("hide");else{const e=l[0];n.querySelector("div:nth-of-type(3)").classList.remove("hide"),n.querySelector("img").src=`/assets/images/stocks/${e.code}-min.png`,n.querySelector("a h5").innerText=e.name,n.querySelector("a").href=`/analisi/${encodeURI(e.name.toLowerCase().replace(/ /g,"-"))}?isin=${e.isin}`,n.querySelector("#mm40days").innerText=e.mm40days?.value?.toFixed(2),n.querySelector("#mm100days").innerText=e.mm100days?.value?.toFixed(2),n.querySelector("#lastprice").innerText=e.lastPrice?.value?.toFixed(2),n.querySelector("#date").innerText=new Date(e.updatedAt).toLocaleString();const t=n.querySelector("ul.sameas");for(let e=0;e<l.length;e++){if(0===e)continue;const a=l[e],s=document.createElement("li"),n=document.createElement("a");n.innerText=a.name,n.title=a.name,n.href=`/analisi/${encodeURI(a.name.toLowerCase().replace(/ /g,"-"))}?isin=${a.isin}`,s.appendChild(n),t.appendChild(s)}}const c=e.tidown;if(0===c.length)o.querySelector("div:nth-of-type(2)").classList.remove("hide");else{const e=c[0];o.querySelector("div:nth-of-type(3)").classList.remove("hide"),o.querySelector("img").src=`/assets/images/stocks/${e.code}-min.png`,o.querySelector("a h5").innerText=e.name,o.querySelector("a").href=`/analisi/${encodeURI(e.name.toLowerCase().replace(/ /g,"-"))}?isin=${e.isin}`,o.querySelector("#mm40days").innerText=e.mm40days?.value?.toFixed(2),o.querySelector("#mm100days").innerText=e.mm100days?.value?.toFixed(2),o.querySelector("#lastprice").innerText=e.lastPrice?.value?.toFixed(2),o.querySelector("#date").innerText=new Date(e.updatedAt).toLocaleString();const t=o.querySelector("ul.sameas");for(let e=0;e<c.length;e++){if(0===e)continue;const a=c[e],s=document.createElement("li"),n=document.createElement("a");n.innerText=a.name,n.title=a.name,n.href=`/analisi/${encodeURI(a.name.toLowerCase().replace(/ /g,"-"))}?isin=${a.isin}`,s.appendChild(n),t.appendChild(s)}}})(e,t)}},r=o,i={init:(e,t)=>{!async function(e,t){const a=e.uptrends,s=e.downtrends,n=t.querySelector("#uptrend").querySelector("tbody"),o=t.querySelector("#downtrend").querySelector("tbody");for(const e of a){const t=document.createElement("tr"),a=document.createElement("td"),s=document.createElement("a");s.innerText=e.name,s.title=e.name,s.href=`/analisi/${encodeURI(e.name?.toLowerCase().replace(/ /g,"-"))}?isin=${e.isin}`,a.appendChild(s);const o=document.createElement("td");o.classList.add("green"),o.innerText=e.lastPrice?.value;const r=document.createElement("td");r.innerText=e.mm20days?.value;const i=document.createElement("td");i.innerText=e.mm40days?.value;const l=document.createElement("td");l.innerText=e.mm100days?.value,t.appendChild(a),t.appendChild(o),t.appendChild(r),t.appendChild(i),t.appendChild(l),n.appendChild(t)}for(const e of s){const t=document.createElement("tr"),a=document.createElement("td"),s=document.createElement("a");s.innerText=e.name,s.title=e.name,s.href=`/analisi/${encodeURI(e.name?.toLowerCase().replace(/ /g,"-"))}?isin=${e.isin}`,a.appendChild(s);const n=document.createElement("td");n.classList.add("red"),n.innerText=e.lastPrice?.value;const r=document.createElement("td");r.innerText=e.mm20days?.value;const i=document.createElement("td");i.innerText=e.mm40days?.value;const l=document.createElement("td");l.innerText=e.mm100days?.value,t.appendChild(a),t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(l),o.appendChild(t)}}(e,t)}},l=i;let c,d,u,y;function m(e="A"){const t=u.getElementsByClassName("stock");Array.from(t).forEach((t=>{if(y.add(t.dataset.letter),t.dataset.letter.toUpperCase()===e){const e=t.querySelector("img");e.dataset.status||(e.dataset.status="loaded",e.src=`/assets/images/stocks/${t.dataset.code}-min.png`),t.classList.remove("hide")}else t.classList.add("hide")}))}const p=()=>{c=document.getElementById("stocks_list"),d=c.getElementsByClassName("alphabet")[0],u=c.getElementsByClassName("stocks")[0],y=new Set,m(),function(){const e=d.querySelectorAll("span");Array.from(e).forEach((e=>{y.has(e.innerText)?e.addEventListener("click",(()=>{m(e.innerText)})):e.classList.add("disabled")}))}()};let v,f;function h(e){const t=v.getElementsByClassName(e.name)[0];t.classList.remove(...f),t.classList.add(e.status)}function g(e){if(e.stocks){const t=v.getElementsByClassName(e.name)[0],a=t.getElementsByTagName("ul")[0];for(const t of e.stocks){const s=document.createElement("li"),n=document.createElement("a");n.innerText=t.name,n.title=t.name,n.href=`/analisi/${encodeURI(t.name?.toLowerCase().replace(/ /g,"-"))}?isin=${t.isin}`;const o=document.createElement("span"),r=Array.isArray(t[e.key].value)?t[e.key].value.join(" - "):t[e.key].value;o.innerText=r||"",s.appendChild(n),s.appendChild(o),a.appendChild(s)}t.appendChild(a)}}const S={init:async e=>{v=document.getElementById("api_list"),f=["idle","loading","success","error"],await async function(e){const t=[];for(const a of e)"api"===a.category&&("idle"===a.status?(a.status="loading",h(a),t.push(new Promise(((e,t)=>{e(n.get(`api/stocks/${a.name}/?${a.qp}`))})).then((e=>{a.stocks=e.body,a.status="success",g(a)})).catch((e=>{a.status="error",console.error(e)})).finally((()=>{h(a)})))):g(a));await Promise.all(t)}(e)}},q=S;let b,k,x;function T(e){let t=0,a=0;if("tendency"===e.name){let t=0;for(const a of e.stocks)"Rialzo"===a.sol24_shortTendency.value&&t++;e.value=(e.stocks.length/t).toFixed(2)}else{for(const s of e.stocks){let n=s[e.name].value;n&&("string"==typeof n&&(n=parseInt(n.replace(",",".").replace("%",""))),a++,t+=n)}e.value=(t/a).toFixed(2)}}function w(e){const t=b.querySelector(`.${e.class}`),a=t.querySelector("img"),s=t.querySelector("span");a.src=e.iconValue,s.innerText=e.value,t.classList.remove(...k),t.classList.add("success")}const L={init:e=>{b=document.getElementById("aggregator"),k=["idle","loading","success","error"],x={performance:{id:0,name:"perf1M",class:"performance",stocks:void 0,value:void 0,get iconValue(){let e;switch(!0){case this.value>14:e=5;break;case this.value>7&&this.value<=14:e=4;break;case this.value>=0&&this.value<=7:e=3;break;case this.value<0&&this.value>=-7:e=2;break;case this.value<-7&&this.value>=-14:e=1;break;case this.value<-14:e=0;break;default:e=""}return`/assets/images/gauge/gauge_${e}-min.png`}},volatility:{id:1,name:"volatility",class:"volatility",stocks:void 0,value:void 0,get iconValue(){let e;switch(!0){case this.value>70:e=0;break;case this.value>56:e=1;break;case this.value>44:e=2;break;case this.value>32:e=3;break;case this.value>20:e=4;break;default:e=5}return`/assets/images/gauge/gauge_${e}-min.png`}},tendency:{id:2,name:"tendency",class:"tendency",stocks:void 0,value:void 0,get iconValue(){let e;switch(!0){case this.value<1.2:e=5;break;case this.value<1.7:e=4;break;case this.value<2.5:e=3;break;case this.value<3.8:e=2;break;case this.value<5.9:e=1;break;default:e=0}return`/assets/images/gauge/gauge_${e}-min.png`}}};for(const t of e)"perf1M"===t.name&&(x.performance.stocks=t.stocks),"volatility"===t.name&&(x.volatility.stocks=t.stocks),"shortTendency"===t.name&&(x.tendency.stocks=t.stocks);T(x.performance),T(x.volatility),T(x.tendency),w(x.performance),w(x.volatility),w(x.tendency)}},E=L,_=JSON.parse(sessionStorage.getItem("localapi"))||[{category:"api",name:"perf1M",key:"perf1M",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"perf6M",key:"perf6M",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"perf1Y",key:"perf1Y",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"volatility",key:"volatility",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"shortTendency",key:"sol24_shortTendency",qp:"order=asc",stocks:void 0,status:"idle"},{category:"api",name:"divYield",key:"divYield",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"lastDivDate",key:"lastDivDate",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"lastJudgment",key:"lastJudgment",qp:"order=desc",stocks:void 0,status:"idle"},{category:"filters",name:"rating",key:"borsaIt_rating",qp:"order=desc",stocks:void 0,status:"idle"},{category:"filters",name:"mfRanking",key:"milFin_mfRanking",qp:"order=asc",stocks:void 0,status:"idle"},{category:"filters",name:"mediumTendency",key:"sol24_mediumTendency",qp:"order=asc",stocks:void 0,status:"idle"},{category:"filters",name:"rsi",key:"borsaIt_rsi",qp:"order=desc",stocks:void 0,status:"idle"}],C=async()=>{p(),await async function(){const e=document.getElementById("in-trend-stocks"),t=document.getElementById("hp-alerts");e.classList.add("loading"),t.classList.add("loading");try{const a=await n.get("api/custom");r.init(a.body,t),l.init(a.body,e)}catch(a){e.classList.add("error"),t.classList.add("error"),console.error(a)}finally{e.classList.remove("loading"),t.classList.remove("loading")}}(),await q.init(_),E.init(_),sessionStorage.setItem("localapi",JSON.stringify(_))},$={info:{status:"idle",body:void 0},analysis:{status:"idle",body:void 0},news:{status:"idle",body:void 0}},I=["idle","loading","success","error"];let R,F;async function M(e){$[e].status="loading",B(e);try{const t=await n.get(`api/${e}/${F}`);$[e].body=t.body,$[e].status="success"}catch(t){$[e].status="error",console.error(t)}B(e)}function B(e){const t=R.getElementsByClassName(e)[0];t.classList.remove(...I),t.classList.add($[e].status)}const D=async()=>{if(F=new URLSearchParams(window.location.search).get("isin")||window.location.pathname.replace("/stock/",""),R=document.getElementById("stock_info"),F&&(await M("info"),"success"===$.info.status&&function(){R.querySelector(".last-price span").innerText=$.info.body.lastPrice.value||"nd",R.querySelector(".volatility span").innerText=$.info.body.volatility?.value;const e=R.querySelector(".profile div");e.prepend($.info.body.profile?.value),e.querySelector("a").href=$.info.body.profile?.source;const t=R.querySelector(".comment div");t.prepend($.info.body.comment?.value),t.querySelector("a").href=$.info.body.comment?.source;const a=R.querySelector(".dividends");a.querySelector(".divYield span").prepend($.info.body.divYield?.value),a.querySelector(".divValue span").prepend($.info.body.lastDiv?.value),a.querySelector(".lastDiv span").prepend($.info.body.lastDivDate?.value),a.querySelector("a").href=$.info.body.lastDivDate?.source;const s=R.querySelector(".average");s.querySelector(".mm20 span").prepend($.info.body.mm20days?.value),s.querySelector(".mm40 span").prepend($.info.body.mm40days?.value),s.querySelector(".mm100 span").prepend($.info.body.mm100days?.value),s.querySelector("a").href=$.info.body.mm20days?.source;const n=R.querySelector(".minmax");n.querySelector(".absMax span").prepend($.info.body.absMax?.value),n.querySelector(".absMin span").prepend($.info.body.absMin?.value),n.querySelector(".max span").prepend($.info.body.currentYearMax?.value),n.querySelector(".min span").prepend($.info.body.currentYearMin?.value),n.querySelector("a").href=$.info.body.absMax?.source;const o=R.querySelector(".performance");o.querySelector(".perf1M span").prepend($.info.body.perf1M?.value),o.querySelector(".perf6M span").prepend($.info.body.perf6M?.value),o.querySelector(".perf1Y span").prepend($.info.body.perf1Y?.value),o.querySelector("a").href=$.info.body.perf1M?.source}(),await M("analysis"),"success"===$.analysis.status&&function(){const e=R.querySelector(".analysis"),t=e.querySelector(".borsa-italiana-logo");t.querySelector("a").href=$.analysis.body.borsaIt_resistance?.source,t.querySelector("p a").href=$.analysis.body.borsaIt_resistance?.source,t.querySelector(".resistance span").innerText=$.analysis.body.borsaIt_resistance?.value,t.querySelector(".support span").innerText=$.analysis.body.borsaIt_support?.value,t.querySelector(".rsi span").innerText=$.analysis.body.borsaIt_rsi?.value,t.querySelector(".evaluation span").innerText=$.analysis.body.borsaIt_evaluation?.value,t.querySelector(".rating span").innerText=$.analysis.body.borsaIt_rating?.value;const a=e.querySelector(".il-sole-24-ore-logo");a.querySelector("a").href=$.analysis.body.sol24_shortTendency?.source,a.querySelector("p a").href=$.analysis.body.sol24_shortTendency?.source,a.querySelector(".short-tend span").innerText=$.analysis.body.sol24_shortTendency?.value,a.querySelector(".med-tend span").innerText=$.analysis.body.sol24_mediumTendency?.value;const s=e.querySelector(".milano-finanza-logo");s.querySelector("a").href=$.analysis.body.milFin_mfRanking?.source,s.querySelector("p a").href=$.analysis.body.milFin_mfRanking?.source,s.querySelector(".rating span").innerText=$.analysis.body.milFin_mfRanking?.value,s.querySelector(".risk span").innerText=$.analysis.body.milFin_mfRisk?.value;const n=e.querySelector(".soldi-on-line-logo");n.querySelector("a").href=$.analysis.body.sol_lastJudgment?.source,n.querySelector("p a").href=$.analysis.body.sol_lastJudgment?.source,n.querySelector(".date span").innerText=$.analysis.body.sol_lastJudgment?.value[0],n.querySelector(".bank span").innerText=$.analysis.body.sol_lastJudgment?.value[1],n.querySelector(".evaluation span").innerText=$.analysis.body.sol_lastJudgment?.value[2],n.querySelector(".target span").innerText=$.analysis.body.sol_lastJudgment?.value[3];const o=e.querySelector(".teleborsa-logo");o.querySelector("a").href=$.analysis.body.teleb_tbResistance?.source,o.querySelector("p a").href=$.analysis.body.teleb_tbResistance?.source,o.querySelector(".resistance span").innerText=$.analysis.body.teleb_tbResistance?.value,o.querySelector(".support span").innerText=$.analysis.body.teleb_tbSupport?.value,o.querySelector(".trend span").innerText=$.analysis.body.teleb_trend?.value}(),await M("news"),"success"===$.news.status&&function(){const e=R.querySelector(".news").getElementsByTagName("ul")[0];for(const t of $.news.body){const a=document.createElement("li"),s=document.createElement("a");s.innerText=t.title,s.title=t.title,s.href=t.url,s.target="_blank",s.rel="noopener noreferrer",a.appendChild(s),e.appendChild(a)}}(),"success"===$.info.status&&"success"===$.analysis.status))return $};let U;const A={init:async e=>{U=document.getElementById("stock_alerts"),function(e){const t=U.querySelector("#a1"),a=U.querySelector("#a2"),s=U.querySelector("#a3"),n=U.querySelector("#a4"),o=U.querySelector("#a5"),r=U.querySelector("#a6"),i=U.querySelector("#a7"),l=U.querySelector("#a8"),c=U.querySelector("#last-price"),d=e.info.body.lastPrice.value;d&&(c.innerText=d,d>=e.info.body.mm20days.value?t.classList.remove("hide"):a.classList.remove("hide"),d>=e.info.body.mm40days.value?s.classList.remove("hide"):n.classList.remove("hide"),d>=e.analysis.body.borsaIt_resistance.value&&o.classList.remove("hide"),d<e.analysis.body.borsaIt_support.value&&r.classList.remove("hide"),d>=e.analysis.body.teleb_tbResistance.value&&i.classList.remove("hide"),d<e.analysis.body.teleb_tbSupport.value&&l.classList.remove("hide"),U.classList.add("show"))}(e),U.querySelector("i.icon-close").addEventListener("click",(()=>{U.classList.remove("show")}))}},J=A,N=async()=>{const e=await D();await J.init(e)},Y=async()=>{p()};if(e(),t(),a(),location.hash){const e=document.getElementById(location.hash.replace("#",""));e&&setTimeout((()=>{e.scrollIntoView({behavior:"smooth"})}),500)}document.querySelector("body#home")&&C(),document.querySelector("body#analysis")&&N(),document.querySelector("body#err404")&&Y()})();