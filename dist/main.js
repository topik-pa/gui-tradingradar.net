(()=>{"use strict";const e=()=>{const e=document.querySelector("header"),t=e.querySelector(".icon-menu"),s=e.querySelector("nav");t.addEventListener("click",(()=>{s.classList.toggle("show")}))},t=()=>{const e=document.querySelector("#cookie_layer_accept"),t=document.querySelector("#cookie_layer");""===function(e){const t="tradingradar-net-privacy=",s=document.cookie.split(";");for(let e=0;e<s.length;e++){let a=s[e];for(;" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return""}()&&setTimeout((()=>{t.classList.add("active")}),3e3),e.addEventListener("click",(e=>{e.preventDefault(),function(e,t,s){const a=new Date;a.setTime(a.getTime()+10368e6);const o="expires="+a.toUTCString();document.cookie="tradingradar-net-privacy=true;"+o+";path=/"}(),t.classList.remove("active")}))},s=()=>{const e=document.getElementById("goto_top"),t="visible";window.addEventListener("scroll",function(e,t=300){let s;return(...a)=>{clearTimeout(s),s=setTimeout((()=>{e.apply(this,a)}),t)}}((function(){window.scrollY>=200?e.classList.add(t):e.classList.remove(t)}))),e.addEventListener("click",(()=>{window.scrollTo({top:0,behavior:"smooth"})}))},a={get:async(e="/api/")=>{const t={};return await fetch(window.location.origin+"/"+e,{method:"GET"}).then((e=>(t.status=e.status,e.json()))).then((e=>{t.body=e})).catch((e=>{console.error(e)})),t},post:async(e={},t="/api/")=>{const s={},a={method:"POST",body:JSON.stringify(e)};return await fetch(window.location.origin+"/"+t,a).then((e=>(s.status=e.status,e.json()))).then((e=>{s.body=e})).catch((e=>{console.error(e)})),s}},o=a;let r,n,i,l;function c(e="A"){const t=i.getElementsByClassName("stock");Array.from(t).forEach((t=>{if(l.add(t.dataset.letter),t.dataset.letter.toUpperCase()===e){const e=t.querySelector("img");e.dataset.status||(e.dataset.status="loaded",e.src=`/assets/images/stocks/${t.dataset.code}-min.png`),t.classList.remove("hide")}else t.classList.add("hide")}))}const d=()=>{r=document.getElementById("stocks_list"),n=r.getElementsByClassName("alphabet")[0],i=r.getElementsByClassName("stocks")[0],l=new Set,c(),function(){const e=n.querySelectorAll("span");Array.from(e).forEach((e=>{l.has(e.innerText)?e.addEventListener("click",(()=>{c(e.innerText)})):e.classList.add("disabled")}))}()};let u,y;function m(e){const t=u.getElementsByClassName(e.name)[0];t.classList.remove(...y),t.classList.add(e.status)}function p(e){if(e.stocks){const t=u.getElementsByClassName(e.name)[0],s=t.getElementsByTagName("ul")[0];for(const t of e.stocks){const a=document.createElement("li"),o=document.createElement("a");o.innerText=t.name,o.title=t.name,o.href=`/analisi/${encodeURI(t.name?.toLowerCase().replace(/ /g,"-"))}?isin=${t.isin}`;const r=document.createElement("span");r.innerText=Array.isArray(t[e.key].value)?t[e.key].value.join(" - "):t[e.key].value,a.appendChild(o),a.appendChild(r),s.appendChild(a)}t.appendChild(s)}}const v={init:async e=>{u=document.getElementById("api_list"),y=["idle","loading","success","error"],await async function(e){const t=[];for(const s of e)"api"===s.category&&("idle"===s.status?(s.status="loading",m(s),t.push(new Promise(((e,t)=>{e(o.get(`api/stocks/${s.name}/?${s.qp}`))})).then((e=>{s.stocks=e.body,s.status="success",p(s)})).catch((e=>{s.status="error",console.error(e)})).finally((()=>{m(s)})))):p(s));await Promise.all(t)}(e)}},f=v;let g,S,q;function h(e){let t=0,s=0;if("tendency"===e.name){let t=0;for(const s of e.stocks)"Rialzo"===s.sol24_shortTendency.value&&t++;e.value=(e.stocks.length/t).toFixed(2)}else{for(const a of e.stocks){let o=a[e.name].value;o&&("string"==typeof o&&(o=parseInt(o.replace(",",".").replace("%",""))),s++,t+=o)}e.value=(t/s).toFixed(2)}}function b(e){const t=g.querySelector(`.${e.class}`),s=t.querySelector("img"),a=t.querySelector("span");s.src=e.iconValue,a.innerText=e.value,t.classList.remove(...S),t.classList.add("success")}const k={init:e=>{g=document.getElementById("aggregator"),S=["idle","loading","success","error"],q={performance:{id:0,name:"perf1M",class:"performance",stocks:void 0,value:void 0,get iconValue(){let e;switch(!0){case this.value>14:e=5;break;case this.value>7&&this.value<=14:e=4;break;case this.value>=0&&this.value<=7:e=3;break;case this.value<0&&this.value>=-7:e=2;break;case this.value<-7&&this.value>=-14:e=1;break;case this.value<-14:e=0;break;default:e=""}return`/assets/images/gauge/gauge_${e}-min.png`}},volatility:{id:1,name:"volatility",class:"volatility",stocks:void 0,value:void 0,get iconValue(){let e;switch(!0){case this.value>70:e=0;break;case this.value>56:e=1;break;case this.value>44:e=2;break;case this.value>32:e=3;break;case this.value>20:e=4;break;default:e=5}return`/assets/images/gauge/gauge_${e}-min.png`}},tendency:{id:2,name:"tendency",class:"tendency",stocks:void 0,value:void 0,get iconValue(){let e;switch(!0){case this.value<1.2:e=5;break;case this.value<1.7:e=4;break;case this.value<2.5:e=3;break;case this.value<3.8:e=2;break;case this.value<5.9:e=1;break;default:e=0}return`/assets/images/gauge/gauge_${e}-min.png`}}};for(const t of e)"perf1M"===t.name&&(q.performance.stocks=t.stocks),"volatility"===t.name&&(q.volatility.stocks=t.stocks),"shortTendency"===t.name&&(q.tendency.stocks=t.stocks);h(q.performance),h(q.volatility),h(q.tendency),b(q.performance),b(q.volatility),b(q.tendency)}},x=k,T=JSON.parse(sessionStorage.getItem("localapi"))||[{category:"api",name:"perf1M",key:"perf1M",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"perf6M",key:"perf6M",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"perf1Y",key:"perf1Y",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"volatility",key:"volatility",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"shortTendency",key:"sol24_shortTendency",qp:"order=asc",stocks:void 0,status:"idle"},{category:"api",name:"divYield",key:"divYield",qp:"order=desc",stocks:void 0,status:"idle"},{category:"api",name:"lastJudgment",key:"lastJudgment",qp:"",stocks:void 0,status:"idle"},{category:"filters",name:"rating",key:"borsaIt_rating",qp:"order=desc",stocks:void 0,status:"idle"},{category:"filters",name:"mfRanking",key:"milFin_mfRanking",qp:"order=asc",stocks:void 0,status:"idle"},{category:"filters",name:"mediumTendency",key:"sol24_mediumTendency",qp:"order=asc",stocks:void 0,status:"idle"},{category:"filters",name:"rsi",key:"borsaIt_rsi",qp:"order=desc",stocks:void 0,status:"idle"}],w=async()=>{(async()=>{const e=document.getElementById("hp-alerts"),t=e.querySelector(".gcup"),s=e.querySelector(".gcdown"),a=e.querySelector(".tiup"),r=e.querySelector(".tidown");e.classList.add("loading");try{const n=await o.get("api/custom"),i=n.body.gcup;0===i?t.querySelector("div:nth-of-type(2)").classList.remove("hide"):(t.querySelector("div:nth-of-type(3)").classList.remove("hide"),t.querySelector("img").src=`/assets/images/stocks/${i.code}-min.png`,t.querySelector("a h5").innerText=i.name,t.querySelector("a").href=`/analisi/${encodeURI(i.name.toLowerCase().replace(/ /g,"-"))}?isin=${i.isin}`,t.querySelector("#mm20days").innerText=i.mm20days.value.toFixed(2),t.querySelector("#mm40days").innerText=i.mm40days.value.toFixed(2),t.querySelector("#delta").innerText=`${(i.mm20days.value-i.mm40days.value).toFixed(2)}€ / ${((i.mm20days.value-i.mm40days.value)/(i.mm40days.value/100)).toFixed(2)}%`,t.querySelector("#date").innerText=new Date(i.updatedAt).toLocaleString());const l=n.body.gcdown;0===l?s.querySelector("div:nth-of-type(2)").classList.remove("hide"):(s.querySelector("div:nth-of-type(3)").classList.remove("hide"),s.querySelector("img").src=`/assets/images/stocks/${l.code}-min.png`,s.querySelector("a h5").innerText=l.name,s.querySelector("a").href=`/analisi/${encodeURI(l.name.toLowerCase().replace(/ /g,"-"))}?isin=${l.isin}`,s.querySelector("#mm20days").innerText=l.mm20days.value.toFixed(2),s.querySelector("#mm40days").innerText=l.mm40days.value.toFixed(2),s.querySelector("#delta").innerText=`${(l.mm20days.value-l.mm40days.value).toFixed(2)}€ / ${((l.mm20days.value-l.mm40days.value)/(l.mm40days.value/100)).toFixed(2)}%`,s.querySelector("#date").innerText=new Date(l.updatedAt).toLocaleString());const c=n.body.tiup;0===c?a.querySelector("div:nth-of-type(2)").classList.remove("hide"):(a.querySelector("div:nth-of-type(3)").classList.remove("hide"),a.querySelector("img").src=`/assets/images/stocks/${c.code}-min.png`,a.querySelector("a h5").innerText=c.name,a.querySelector("a").href=`/analisi/${encodeURI(c.name.toLowerCase().replace(/ /g,"-"))}?isin=${c.isin}`,a.querySelector("#mm40days").innerText=c.mm40days.value.toFixed(2),a.querySelector("#mm100days").innerText=c.mm100days.value.toFixed(2),a.querySelector("#lastprice").innerText=c.lastPrice.value.toFixed(2),a.querySelector("#date").innerText=new Date(c.updatedAt).toLocaleString());const d=n.body.tidown;0===d?r.querySelector("div:nth-of-type(2)").classList.remove("hide"):(r.querySelector("div:nth-of-type(3)").classList.remove("hide"),r.querySelector("img").src=`/assets/images/stocks/${d.code}-min.png`,r.querySelector("a h5").innerText=d.name,r.querySelector("a").href=`/analisi/${encodeURI(d.name.toLowerCase().replace(/ /g,"-"))}?isin=${d.isin}`,r.querySelector("#mm40days").innerText=d.mm40days.value.toFixed(2),r.querySelector("#mm100days").innerText=d.mm100days.value.toFixed(2),r.querySelector("#lastprice").innerText=d.lastPrice.value.toFixed(2),r.querySelector("#date").innerText=new Date(d.updatedAt).toLocaleString()),e.classList.remove("loading")}catch(t){e.classList.add("error"),console.error(t)}finally{e.classList.remove("loading")}})(),d(),await f.init(T),x.init(T),sessionStorage.setItem("localapi",JSON.stringify(T))},L={info:{status:"idle",body:void 0},analysis:{status:"idle",body:void 0},news:{status:"idle",body:void 0}},_=["idle","loading","success","error"];let E,I;async function $(e){L[e].status="loading",F(e);try{const t=await o.get(`api/${e}/${I}`);L[e].body=t.body,L[e].status="success"}catch(t){L[e].status="error",console.error(t)}F(e)}function F(e){const t=E.getElementsByClassName(e)[0];t.classList.remove(..._),t.classList.add(L[e].status)}const C=async()=>{if(I=new URLSearchParams(window.location.search).get("isin")||window.location.pathname.replace("/stock/",""),E=document.getElementById("stock_info"),I&&(await $("info"),"success"===L.info.status&&function(){E.querySelector(".last-price span").innerText=L.info.body.lastPrice.value||"nd",E.querySelector(".volatility span").innerText=L.info.body.volatility?.value;const e=E.querySelector(".profile div");e.prepend(L.info.body.profile?.value),e.querySelector("a").href=L.info.body.profile?.source;const t=E.querySelector(".comment div");t.prepend(L.info.body.comment?.value),t.querySelector("a").href=L.info.body.comment?.source;const s=E.querySelector(".dividends");s.querySelector(".divYield span").prepend(L.info.body.divYield?.value),s.querySelector(".divValue span").prepend(L.info.body.lastDiv?.value),s.querySelector(".lastDiv span").prepend(L.info.body.lastDivDate?.value),s.querySelector("a").href=L.info.body.lastDivDate?.source;const a=E.querySelector(".average");a.querySelector(".mm20 span").prepend(L.info.body.mm20days?.value),a.querySelector(".mm40 span").prepend(L.info.body.mm40days?.value),a.querySelector(".mm100 span").prepend(L.info.body.mm100days?.value),a.querySelector("a").href=L.info.body.mm20days?.source;const o=E.querySelector(".minmax");o.querySelector(".absMax span").prepend(L.info.body.absMax?.value),o.querySelector(".absMin span").prepend(L.info.body.absMin?.value),o.querySelector(".max span").prepend(L.info.body.currentYearMax?.value),o.querySelector(".min span").prepend(L.info.body.currentYearMin?.value),o.querySelector("a").href=L.info.body.absMax?.source;const r=E.querySelector(".performance");r.querySelector(".perf1M span").prepend(L.info.body.perf1M?.value),r.querySelector(".perf6M span").prepend(L.info.body.perf6M?.value),r.querySelector(".perf1Y span").prepend(L.info.body.perf1Y?.value),r.querySelector("a").href=L.info.body.perf1M?.source}(),await $("analysis"),"success"===L.analysis.status&&function(){const e=E.querySelector(".analysis"),t=e.querySelector(".borsa-italiana-logo");t.querySelector("a").href=L.analysis.body.borsaIt_resistance?.source,t.querySelector("p a").href=L.analysis.body.borsaIt_resistance?.source,t.querySelector(".resistance span").innerText=L.analysis.body.borsaIt_resistance?.value,t.querySelector(".support span").innerText=L.analysis.body.borsaIt_support?.value,t.querySelector(".rsi span").innerText=L.analysis.body.borsaIt_rsi?.value,t.querySelector(".evaluation span").innerText=L.analysis.body.borsaIt_evaluation?.value,t.querySelector(".rating span").innerText=L.analysis.body.borsaIt_rating?.value;const s=e.querySelector(".il-sole-24-ore-logo");s.querySelector("a").href=L.analysis.body.sol24_shortTendency?.source,s.querySelector("p a").href=L.analysis.body.sol24_shortTendency?.source,s.querySelector(".short-tend span").innerText=L.analysis.body.sol24_shortTendency?.value,s.querySelector(".med-tend span").innerText=L.analysis.body.sol24_mediumTendency?.value;const a=e.querySelector(".milano-finanza-logo");a.querySelector("a").href=L.analysis.body.milFin_mfRanking?.source,a.querySelector("p a").href=L.analysis.body.milFin_mfRanking?.source,a.querySelector(".rating span").innerText=L.analysis.body.milFin_mfRanking?.value,a.querySelector(".risk span").innerText=L.analysis.body.milFin_mfRisk?.value;const o=e.querySelector(".soldi-on-line-logo");o.querySelector("a").href=L.analysis.body.sol_lastJudgment?.source,o.querySelector("p a").href=L.analysis.body.sol_lastJudgment?.source,o.querySelector(".date span").innerText=L.analysis.body.sol_lastJudgment?.value[0],o.querySelector(".bank span").innerText=L.analysis.body.sol_lastJudgment?.value[1],o.querySelector(".evaluation span").innerText=L.analysis.body.sol_lastJudgment?.value[2],o.querySelector(".target span").innerText=L.analysis.body.sol_lastJudgment?.value[3];const r=e.querySelector(".teleborsa-logo");r.querySelector("a").href=L.analysis.body.teleb_tbResistance?.source,r.querySelector("p a").href=L.analysis.body.teleb_tbResistance?.source,r.querySelector(".resistance span").innerText=L.analysis.body.teleb_tbResistance?.value,r.querySelector(".support span").innerText=L.analysis.body.teleb_tbSupport?.value,r.querySelector(".trend span").innerText=L.analysis.body.teleb_trend?.value}(),await $("news"),"success"===L.news.status&&function(){const e=E.querySelector(".news").getElementsByTagName("ul")[0];for(const t of L.news.body){const s=document.createElement("li"),a=document.createElement("a");a.innerText=t.title,a.title=t.title,a.href=t.url,a.target="_blank",a.rel="noopener noreferrer",s.appendChild(a),e.appendChild(s)}}(),"success"===L.info.status&&"success"===L.analysis.status))return L};let M;const R={init:async e=>{M=document.getElementById("stock_alerts"),function(e){const t=M.querySelector("#a1"),s=M.querySelector("#a2"),a=M.querySelector("#a3"),o=M.querySelector("#a4"),r=M.querySelector("#a5"),n=M.querySelector("#a6"),i=M.querySelector("#a7"),l=M.querySelector("#a8"),c=M.querySelector("#last-price"),d=e.info.body.lastPrice.value;d&&(c.innerText=d,d>=e.info.body.mm20days.value?t.classList.remove("hide"):s.classList.remove("hide"),d>=e.info.body.mm40days.value?a.classList.remove("hide"):o.classList.remove("hide"),d>=e.analysis.body.borsaIt_resistance.value&&r.classList.remove("hide"),d<e.analysis.body.borsaIt_support.value&&n.classList.remove("hide"),d>=e.analysis.body.teleb_tbResistance.value&&i.classList.remove("hide"),d<e.analysis.body.teleb_tbSupport.value&&l.classList.remove("hide"),M.classList.add("show"))}(e),M.querySelector("i.icon-close").addEventListener("click",(()=>{M.classList.remove("show")}))}},B=R,D=async()=>{const e=await C();await B.init(e)},A=async()=>{d()};if(e(),t(),s(),location.hash){const e=document.getElementById(location.hash.replace("#",""));e&&setTimeout((()=>{e.scrollIntoView({behavior:"smooth"})}),500)}document.querySelector("body#home")&&w(),document.querySelector("body#analysis")&&D(),document.querySelector("body#err404")&&A()})();